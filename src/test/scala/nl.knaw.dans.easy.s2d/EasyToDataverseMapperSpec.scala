package nl.knaw.dans.easy.s2d

import nl.knaw.dans.easy.s2d.dataverse.json.PrimitiveFieldSingleValue
import org.json4s.DefaultFormats
import org.scalatest.{ Assertions, FlatSpec }

class EasyToDataverseMapperSpec extends FlatSpec with Assertions {
  implicit val format = DefaultFormats
  private val ddmNodeString = "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!--\n    Copyright (C) 2019 DANS - Data Archiving and Networked Services (info@dans.knaw.nl)\n    Licensed under the Apache License, Version 2.0 (the \"License\");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n    http://www.apache.org/licenses/LICENSE-2.0\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an \"AS IS\" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n-->\n<ddm:DDM\n        xmlns:dcx-dai=\"http://easy.dans.knaw.nl/schemas/dcx/dai/\"\n        xmlns:dcx-gml=\"http://easy.dans.knaw.nl/schemas/dcx/gml/\"\n        xmlns:ddm=\"http://easy.dans.knaw.nl/schemas/md/ddm/\"\n        xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n        xmlns:narcis=\"http://easy.dans.knaw.nl/schemas/vocab/narcis-type/\"\n        xmlns:abr=\"http://www.den.nl/standaard/166/Archeologisch-Basisregister/\"\n        xmlns:dc=\"http://purl.org/dc/elements/1.1/\"\n        xmlns:dct=\"http://purl.org/dc/terms/\"\n        xmlns:dcterms=\"http://purl.org/dc/terms/\"\n\n        xsi:schemaLocation=\"\n            http://easy.dans.knaw.nl/schemas/md/ddm/ https://easy.dans.knaw.nl/schemas/md/ddm/ddm.xsd\n            http://www.loc.gov/mods/v3 http://www.loc.gov/standards/mods/v3/mods-3-7.xsd\n        \">\n\n    <!-- If you view this example in a browser, click 'page source' to see the namespace declarations. -->\n\n    <!--\n    Example of a DDM instance. A DDM instance is subdivided into three container elements:\n    ddm:profile (required), ddm:dcmiMetadata (optional), ddm:additional-xml (optional).\n    This example shows all the fields that will show up as meta data:\n    a) in a license document of the ingest confirmation message\n    b) on the description tab of the dataset in the web-ui\n    -->\n\n    <!-- DDM instances MUST have one ddm:profile element  -->\n    <ddm:profile>\n        <!--\n        The information in this group is essential for profiling the dataset in the Easy application.\n        Elements must appear in a predefined order.\n        The use of xml:lang and xsi:type attributes, where applicable, is recommended.\n        -->\n\n        <!-- One or more dc:title, dct:title, dct:alternative -->\n        <dc:title xml:lang=\"en\">Titel van test dataset DANS</dc:title>\n        <dc:title xml:lang=\"nl\">Titel van de dataset</dc:title>\n\n        <!-- One or more dc:description, dct:description, dct:abstract, dct:tableOfContents -->\n        <dc:description xml:lang=\"la\">Lorem ipsum dolor sit amet, consectetur adipiscing elit.</dc:description>\n\n        <!-- One or more dc:creator, dct:creator, dcx-dai:creator, dcx-dai:creatorDetails.\n        Use elements from substitution groups that convey detailed information, when possible. -->\n        <dcx-dai:creatorDetails>\n            <dcx-dai:author>\n                <dcx-dai:titles>Prof.</dcx-dai:titles>\n                <dcx-dai:initials>D.N.</dcx-dai:initials>\n                <dcx-dai:insertions>van den</dcx-dai:insertions>\n                <dcx-dai:surname>Aarden</dcx-dai:surname>\n                <dcx-dai:DAI>123456789</dcx-dai:DAI>\n                <dcx-dai:organization>\n                    <dcx-dai:name xml:lang=\"en\">Utrecht University</dcx-dai:name>\n                </dcx-dai:organization>\n            </dcx-dai:author>\n        </dcx-dai:creatorDetails>\n\n        <!-- Exactly one ddm:created. The value of the ddm:created element must comply to W3CDTF.\n        Examples of valid values: 2012, 2012-12, 2012-12-15. -->\n        <ddm:created>2012-12</ddm:created>\n\n        <!-- Zero or one ddm:available. With the optional element ddm:available the end date of\n        an embargo period may be specified. The value of the ddm:available element must comply to W3CDTF. -->\n<!--        AANGEPAST was 2012-12-->\n        <ddm:available>Yes</ddm:available>\n\n        <!-- One or more ddm:audience. Use codes specified in\n             http://easy.dans.knaw.nl/schemas/vocab/2012/10/narcis-type.xsd  -->\n        <ddm:audience>Law</ddm:audience>\n        <ddm:audience>Agricultural Sciences</ddm:audience>\n\n        <!-- Exactly one ddm:accessRights. Valid codes for the element ddm:accessRights are\n        OPEN_ACCESS, REQUEST_PERMISSION and NO_ACCESS. -->\n        AANGEPAST was REQUEST_PERMISSION\n        <ddm:accessRights>Restricted Access</ddm:accessRights>\n\n    </ddm:profile>\n\n    <!-- DDM instances MAY have one ddm:dcmiMetadata element -->\n    <ddm:dcmiMetadata>\n<!--        <dcterms:audience xsi:type='narcis:DisciplineType'>D24000</dcterms:audience>-->\n\n        <!-- Sword-V1 returns HTTP/1.1 500 Internal Server Error with the following fields -->\n        <!--<dcterms:audience xsi:type='narcis:DisciplineType'>D34500</dcterms:audience>-->\n        <!--<dcterms:educationLevel>meer vrije tekst</dcterms:educationLevel>-->\n        <!--<dcterms:audience>vrije tekst</dcterms:audience>-->\n        <!--<dcterms:audience>D24000</dcterms:audience>-->\n\n        <!-- ================================================================ not copied to EMD -->\n\n        <!-- with 'skipped' warnings -->\n        <dcterms:accessRights>not implemented 1</dcterms:accessRights>\n        <dc:rights>not implemented 2</dc:rights>\n        <dcterms:rights>not implemented 3</dcterms:rights>\n        <dcterms:temporal xsi:type=\"abr:ABRperiode\">PALEOLB</dcterms:temporal>\n        <!-- See http://dublincore.org/documents/dcmi-period/#sec4  -->\n        <dc:coverage xsi:type=\"dct:Period\">name=The Great Depression; start=1929; end=1939;</dc:coverage>\n        <dc:subject xsi:type=\"abr:ABRcomplex\">EGVW</dc:subject>\n        <dcterms:subject xsi:type=\"abr:ABRcomplex\">ELA</dcterms:subject>\n\n        <!-- no 'skipped' warnings -->\n        <dcterms:audience><!-- empty: does not show up --></dcterms:audience>\n        <dcterms:instructionalMethod>Yes</dcterms:instructionalMethod>\n        <dcterms:accrualMethod>not supported 02</dcterms:accrualMethod>\n        <dcterms:accrualPolicy>not supported 03</dcterms:accrualPolicy>\n        <dcterms:accrualPeriodicity>not supported 04</dcterms:accrualPeriodicity>\n        <dcterms:mediator>not supported 05</dcterms:mediator>\n        <dcterms:provenance>not supported 06</dcterms:provenance>\n        <dcterms:bibliographicCitation>not supported 07</dcterms:bibliographicCitation>\n        <dcterms:medium>not supported 08</dcterms:medium>\n        <dcterms:license>not supported 09</dcterms:license>\n        <dcterms:extent>not supported 10</dcterms:extent>\n        <dcterms:abstract>not implemented 5</dcterms:abstract>\n        <dcterms:tableOfContents>not implemented 6</dcterms:tableOfContents>\n\n        <dcterms:relation xsi:type='dcterms:URI'>not implemented because of the type</dcterms:relation>\n\n        <!--  ================================================================ relations -->\n\n        <!-- Sword-V1 returns HTTP/1.1 415 Unsupported Media Type:\n            Could not create EMD from DDM\n            Cannot resolve 'id-type:URN' as a QName: the prefix 'id-type' is not declared\n        -->\n        <!--<dc:relation xsi:type=\"id-type:URN\">urn:nbn:nl:ui:13-fant-asy</dc:relation>-->\n        <!--<dcterms:relation xsi:type=\"id-type:DOI\">10.5072/fantasy-doi-rel</dcterms:relation>-->\n\n        <ddm:relation scheme=\"STREAMING_SURROGATE_RELATION\">/domain/dans/user/somebody/collection/test1/presentation/testA</ddm:relation>\n        <dc:relation>urn:nbn:nl:ui:13-fant-asy</dc:relation>\n        <dcterms:relation>10.5072/fantasy-doi-rel</dcterms:relation>\n        <ddm:conformsTo scheme=\"DOI\">http://doi.org/10.1111/sode.12120</ddm:conformsTo>\n        <ddm:isVersionOf href=\"http://hdl.handle.net/2066/121062\">http://hdl.handle.net/2066/121062</ddm:isVersionOf>\n        <ddm:hasVersion scheme=\"URN\">http://www.persistent-identifier.nl/?identifier=urn:nbn:nl:ui:13-2ajw-cq</ddm:hasVersion>\n        <dcterms:isReplacedBy>A descriptin of object 6</dcterms:isReplacedBy>\n        <dcterms:replaces>A descriptin of object 7</dcterms:replaces>\n        <dcterms:isRequiredBy>A descriptin of object 8</dcterms:isRequiredBy>\n        <dcterms:requires>A descriptin of object 9</dcterms:requires>\n        <dcterms:isPartOf>A descriptin of object 10</dcterms:isPartOf>\n        <dcterms:hasPart>A descriptin of object 11</dcterms:hasPart>\n        <dcterms:isReferencedBy>A descriptin of object 12</dcterms:isReferencedBy>\n        <dcterms:references>A descriptin of object 13</dcterms:references>\n        <dcterms:isFormatOf>A descriptin of object 14</dcterms:isFormatOf>\n        <dcterms:hasFormat>A descriptin of object 15</dcterms:hasFormat>\n<!--        Zelf ingevoegd-->\n        <dcx-dai:contributorDetails>\n            <dcx-dai:author>\n                <dcx-dai:titles xml:lang=\"nld\">Mr</dcx-dai:titles>\n                <dcx-dai:initials>A.v.d.P</dcx-dai:initials>\n                <dcx-dai:insertions>van</dcx-dai:insertions>\n                <dcx-dai:surname>der Pol</dcx-dai:surname>\n                <dcx-dai:DAI>info:eu-repo/dai/nl/358163587</dcx-dai:DAI>\n                <dcx-dai:ISNI>000000012281955X</dcx-dai:ISNI>\n                <dcx-dai:ORCID>0000-0002-1825-0097</dcx-dai:ORCID>\n                <dcx-dai:role>Other</dcx-dai:role>\n            </dcx-dai:author>\n        </dcx-dai:contributorDetails>\n        <dcx-dai:contributorDetails>\n            <dcx-dai:organization>\n                <dcx-dai:name xml:lang=\"nld\">knaw</dcx-dai:name>\n                <dcx-dai:role>RightsHolder</dcx-dai:role>\n            </dcx-dai:organization>\n        </dcx-dai:contributorDetails>\n        <dcx-dai:contributorDetails>\n            <dcx-dai:author>\n                <dcx-dai:initials>P.O.L.</dcx-dai:initials>\n                <dcx-dai:surname>Lima</dcx-dai:surname>\n                <dcx-dai:role>RightsHolder</dcx-dai:role>\n                <dcx-dai:organization>\n                    <dcx-dai:name xml:lang=\"nld\">als eerdere varianten</dcx-dai:name>\n                </dcx-dai:organization>\n            </dcx-dai:author>\n        </dcx-dai:contributorDetails>\n\n        <!-- ================================================================ dates -->\n\n        <ddm:available>YES</ddm:available>\n        <dcterms:created xsi:type='dcterms:W3CDTF'>1901-04-01</dcterms:created>\n        <dcterms:created>03-2013</dcterms:created>\n        <dcterms:available xsi:type='dcterms:W3CDTF'>1902-04-01</dcterms:available>\n        <dcterms:available>04-2013</dcterms:available>\n        <dcterms:dateAccepted xsi:type='dcterms:W3CDTF'>1903-04-01</dcterms:dateAccepted>\n        <dcterms:dateAccepted>05-2013</dcterms:dateAccepted>\n        <dcterms:valid xsi:type='dcterms:W3CDTF'>1904-04-01</dcterms:valid>\n        <dcterms:valid>06-2013</dcterms:valid>\n        <dcterms:issued xsi:type='dcterms:W3CDTF'>1905-04-03</dcterms:issued>\n        <dcterms:issued>07-2013</dcterms:issued>\n        <dcterms:modified xsi:type='dcterms:W3CDTF'>1906-04-08</dcterms:modified>\n        <dcterms:modified>08-2013</dcterms:modified>\n        <dcterms:dateCopyrighted xsi:type='dcterms:W3CDTF'>1907-04-07</dcterms:dateCopyrighted>\n        <dcterms:dateCopyrighted>09-2013</dcterms:dateCopyrighted>\n        <dcterms:dateSubmitted xsi:type='dcterms:W3CDTF'>1908-04-04</dcterms:dateSubmitted>\n        <dcterms:dateSubmitted>10-2013</dcterms:dateSubmitted>\n        <dcterms:date xsi:type='dcterms:W3CDTF'>1909-04-02</dcterms:date>\n        <dcterms:date>11-2013</dcterms:date>\n        <dc:date xsi:type='dcterms:W3CDTF'>1910-04-05</dc:date>\n        <dc:date>12-2013</dc:date>\n\n        <!-- ================================================================ authors -->\n\n        <dcterms:rightsHolder>Houder van rechten</dcterms:rightsHolder>\n        <dcx-dai:creator DAI='info:eu-repo/dai/nl/9876543216'><!-- empty: does not show up --></dcx-dai:creator>\n        <dc:creator>maker</dc:creator>\n        <dc:contributor>bijdrager</dc:contributor>\n        <dcterms:creator>maker term</dcterms:creator>\n        <dcterms:contributor>bijdrager term</dcterms:contributor>\n\n        <!-- Sword-V1 returns HTTP/1.1 400 Bad Request: invalid meta data [Incomplete value eas.creator index=1] -->\n        <!--<dcx-dai:creator DAI='info:eu-repo/dai/nl/1234567897'>maker met dai</dcx-dai:creator>-->\n\n        <!-- Sword-V1 returns HTTP/1.1 400 Bad Request: invalid meta data [Incomplete value eas.contributor index=0] -->\n        <!--<dcx-dai:contributor DAI='1234567897'>bijdrager met DAI</dcx-dai:contributor>-->\n\n\n        <dcx-dai:creatorDetails>\n            <dcx-dai:author>\n                <dcx-dai:titles xml:lang=\"en-IE\">dr.</dcx-dai:titles>\n                <dcx-dai:initials>P</dcx-dai:initials>\n                <dcx-dai:insertions>v.d.</dcx-dai:insertions>\n                <dcx-dai:surname>P</dcx-dai:surname>\n                <dcx-dai:DAI>933139357</dcx-dai:DAI>\n                <dcx-dai:organization>\n                    <dcx-dai:name xml:lang=\"zh-CN\">DC.LPEeo</dcx-dai:name>\n                </dcx-dai:organization>\n            </dcx-dai:author>\n        </dcx-dai:creatorDetails>\n        <dcx-dai:contributorDetails>\n            <dcx-dai:author>\n                <dcx-dai:titles>Prof.</dcx-dai:titles>\n                <dcx-dai:initials>A.A.</dcx-dai:initials>\n                <dcx-dai:surname>Jansen</dcx-dai:surname>\n                <dcx-dai:DAI>123456789</dcx-dai:DAI>\n                <dcx-dai:organization>\n                    <dcx-dai:name>Babylon b.v.</dcx-dai:name>\n                </dcx-dai:organization>\n            </dcx-dai:author>\n        </dcx-dai:contributorDetails>\n\n        <!-- =================================================== language -->\n\n        <dcterms:language>Dutch</dcterms:language>\n<!--        <dcterms:language>Bosnian</dcterms:language>-->\n        <dc:language>English</dc:language>\n        <dc:language xsi:type='dcterms:ISO639-3'>Dutch</dc:language>\n        <dc:language xsi:type='dcterms:ISO639-2'>Breton</dc:language>\n\n\n<!--        <dcterms:language>Nederlands</dcterms:language>-->\n<!--        <dc:language>Engels</dc:language>-->\n<!--        <dc:language xsi:type='dcterms:ISO639-3'>nld</dc:language>-->\n<!--        <dc:language xsi:type='dcterms:ISO639-2'>eng</dc:language>-->\n<!--        <dcterms:language xsi:type='dcterms:ISO639-3'>deu</dcterms:language>-->\n<!--        <dcterms:language xsi:type='dcterms:ISO639-2'>fre</dcterms:language>-->\n\n        <!-- =================================================== misceleneous -->\n        <dcterms:identifier>some ientifier 1</dcterms:identifier>\n<!--        <dcterms:identifier xsi:type=\"id-type:DOI\">10.1234/fantasy-doi-id</dcterms:identifier>-->\n        <dc:identifier>some ientifier 2</dc:identifier>\n        <dcterms:description>beschrijving</dcterms:description>\n        <dcterms:format>formaat</dcterms:format>\n        <dcterms:alternative>alternatief</dcterms:alternative>\n        <dcterms:title>titel</dcterms:title>\n        <dcterms:publisher>uitgever</dcterms:publisher>\n        <dcterms:type>tiepe</dcterms:type>\n        <dcterms:source>bron</dcterms:source>\n        <dc:description>Beschrijving</dc:description>\n        <dc:format>Formaat</dc:format>\n        <dc:title>Titel</dc:title>\n        <dc:publisher>YES</dc:publisher>\n        <dc:type>Tiepe</dc:type>\n        <dc:source>nog een bron</dc:source>\n        <dcterms:subject>onderwerp</dcterms:subject>\n\n        <!-- Repeat elements that have independent meaning -->\n        <dc:subject>school leavers</dc:subject>\n        <dc:subject>labour market</dc:subject>\n\n        <!-- Use explicitely typed values, when possible -->\n        <dct:issued xsi:type=\"dct:W3CDTF\">2012-10-09</dct:issued>\n\n        <!-- ====================================================== coverage -->\n\n        <dc:coverage>Dekking</dc:coverage>\n        <dcterms:coverage>meer dekking</dcterms:coverage>\n\n        <!-- On or more items per period -->\n\n        <dcterms:temporal>bronzen tijdperk</dcterms:temporal>\n\n        <!-- On or more items per location -->\n\n        <dcterms:spatial>Ruimte</dcterms:spatial>\n        <dcterms:spatial xsi:type=\"dcx-gml:SimpleGMLType\">\n            <Point xmlns=\"http://www.opengis.net/gml\">\n                <pos>1.0 2.0</pos>\n            </Point>\n        </dcterms:spatial>\n        <dcx-gml:spatial>\n            <Point xmlns=\"http://www.opengis.net/gml\">\n                <pos>\n                    52.08113 4.34510\n                </pos>\n            </Point>\n        </dcx-gml:spatial>\n        <dcx-gml:spatial>\n            <Point xmlns=\"http://www.opengis.net/gml\">\n                <description>Entrance of DANS Building</description>\n                <name>Data Archiving and Networked Services (DANS)</name>\n                <pos>52.08110 4.34521 1.12</pos>\n            </Point>\n        </dcx-gml:spatial>\n        <dcx-gml:spatial srsName=\"http://www.opengis.net/def/crs/EPSG/0/28992\">\n            <!-- fields with an explicit srsName will not show up in EMD -->\n            <Point xmlns=\"http://www.opengis.net/gml\">\n                <!-- Same point in Dutch National Grid (urn:ogc:def:crs:EPSG::28992).\n                    The list in element pos is in the order x y [altitude]. All units in m. -->\n                <description>Entrance of DANS Building</description>\n                <name>Data Archiving and Networked Services (DANS)</name>\n                <pos>83575.4 455271.2 1.12</pos>\n            </Point>\n        </dcx-gml:spatial>\n        <dcx-gml:spatial>\n            <boundedBy xmlns=\"http://www.opengis.net/gml\">\n                <Envelope srsName=\"urn:ogc:def:crs:EPSG::28992\">\n                    <lowerCorner>91232.015554 436172.485680</lowerCorner><!-- Rotterdam -->\n                    <upperCorner>121811.885272 486890.494251</upperCorner><!-- Amsterdam -->\n                </Envelope>\n            </boundedBy>\n        </dcx-gml:spatial>\n        <dcx-gml:spatial>\n            <Polygon xmlns=\"http://www.opengis.net/gml\" srsName=\"http://www.opengis.net/def/crs/EPSG/0/4326\">\n                <description>A triangle between DANS, NWO and the railway station</description>\n                <exterior>\n                    <LinearRing>\n                        <description>main triangle</description>\n                        <posList>52.080741 4.345312 52.08071 4.34422 52.07913 4.34332 52.080741 4.345312</posList>\n                    </LinearRing>\n                </exterior>\n                <interior>\n                    <LinearRing>\n                        <description>hole1</description>\n                        <posList>52.080542 4.344215 52.080450 4.344323 52.080357 4.344110 52.080542 4.344215</posList>\n                    </LinearRing>\n                </interior>\n                <interior>\n                    <LinearRing>\n                        <description>hole2</description>\n                        <posList>52.080542 4.344215 52.080450 4.344323 52.080357 4.344110 52.080542 4.344215</posList>\n                    </LinearRing>\n                </interior>\n            </Polygon>\n        </dcx-gml:spatial>\n        <dcx-gml:spatial>\n            <MultiSurface xmlns=\"http://www.opengis.net/gml\">\n                <name>A random surface with multiple polygons</name>\n                <surfaceMember>\n                    <Polygon srsName=\"http://www.opengis.net/def/crs/EPSG/0/4326\">\n                        <description>A triangle between DANS, NWO and the railway station</description>\n                        <exterior>\n                            <LinearRing>\n                                <description>main triangle</description>\n                                <posList>52.080741 4.345312 52.08071 4.34422 52.07913 4.34332 52.080741 4.345312</posList>\n                            </LinearRing>\n                        </exterior>\n                        <interior>\n                            <LinearRing>\n                                <description>hole in the triangle</description>\n                                <posList>52.080542 4.344215 52.080450 4.344323 52.080357 4.344110 52.080542 4.344215</posList>\n                            </LinearRing>\n                        </interior>\n                    </Polygon>\n                </surfaceMember>\n                <surfaceMember>\n                    <Polygon srsName=\"http://www.opengis.net/def/crs/EPSG/0/4326\">\n                        <description>A triangle between BP, De Horeca Academie en the railway station</description>\n                        <exterior>\n                            <LinearRing>\n                                <posList>52.079710 4.342778 52.080518 4.343342 52.07913 4.34332 52.079710 4.342778</posList>\n                            </LinearRing>\n                        </exterior>\n                    </Polygon>\n                </surfaceMember>\n            </MultiSurface>\n        </dcx-gml:spatial>\n\n        <!-- not copied to EMD, see SWORD v1 packaging document: it has no mapping for dcterms:Box -->\n        <dcterms:spatial xsi:type=\"dcterms:Box\">name=Western Australia; northlimit=-13.5; southlimit=-35.5; westlimit=112.5; eastlimit=129</dcterms:spatial>\n\n        <!-- Use ';' for separation of list items. Use of line breaks is allowed -->\n        <dct:tableOfContents>\n            Introduction;\n            1. The Restaurant at the End of the Universe;\n            2. Life, the Universe and Everything\n        </dct:tableOfContents>\n\n        </ddm:dcmiMetadata>\n\n        <!-- DDM instances MAY have one ddm:additional-xml element -->\n<ddm:additional-xml>\n<!--\nThe content of the ddm:additional-xml element is free, as long as its namespace is ##other.\nUse this element for short notations. Complete metadata records in other formats should\npreferably go into separate files.\nNothing will be copied to EMD\nBelow is an example of usage of the ddm:additional-xml element. It uses a mods:recordInfo\nelement to provide meaningfull information about the origin of this DDM instance.\n-->\n<mods:recordInfo xmlns:mods=\"http://www.loc.gov/mods/v3\">\n    <mods:recordContentSource>My Company</mods:recordContentSource>\n    <mods:recordCreationDate encoding=\"w3cdtf\">2013-01-16T13:31:22.874Z</mods:recordCreationDate>\n    <mods:recordOrigin>machine generated</mods:recordOrigin>\n</mods:recordInfo>\n</ddm:additional-xml>\n        </ddm:DDM>"
  private val ddmNode = scala.xml.XML.loadString(ddmNodeString)
  val mapper = new EasyToDataverseMapper

  //1: check if fieldd have been updated correctly
  //2 check if added object render to json correctly (intermediate check)

  "metadatablock fields" should "be updated correctly" in {
    mapper.mapToPrimitiveFieldsSingleValue(ddmNode)
    assert(mapper.citationFields.size > 0)
    assert(mapper.citationFields.contains(PrimitiveFieldSingleValue("alternativeTitle", false, "primitive", "alternatief")))
    assert(mapper.citationFields.contains(PrimitiveFieldSingleValue("productionDate", false, "primitive", "2012-12")))
  }

  it should "generate Dataverse-valid json" in {
    val jsonResult = "{\n\"typeName\":\"alternativeTitle\",\n\"multiple\":false,\n\"typeClass\":\"primitive\",\n\"value\":\"alternatief\"\n}"
    mapper.mapToPrimitiveFieldsSingleValue(ddmNode)
    //assert(Serialization.writePretty(mapper.citationFields.last).trim == jsonResult.trim)

  }
}
